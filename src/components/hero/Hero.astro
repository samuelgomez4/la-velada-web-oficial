---
import { FIGHTERS } from "@/consts/fighters"
import BoxerCard from "./BoxerCard.astro"
import Landing from "./Landing.astro"
import FighterContainer from "./FighterContainer.astro"
import HeroDesktop from "./HeroDesktop.astro" // Import HeroDesktop
import HeroMobile from "./HeroMobile.astro"

const firstRow = FIGHTERS.slice(0, 6)
const leftRow = firstRow.slice(0, 3)
const rightRow = firstRow.slice(3)
const secondRow = FIGHTERS.slice(6)
const leftBottom = secondRow.slice(0, 4)
const rightBottom = secondRow.slice(4)
---

<section class="relative flex min-h-screen w-full">
  <div
    class="bg-[url('/images/hero.png')] bg-cover bg-center w-full mask-fade-bottom absolute inset-0"
  >
  </div>
  <div class="hidden sm:block w-full">
    <HeroDesktop {leftRow} {rightRow} {secondRow} />
  </div>
  <div class="block sm:hidden w-full">
    <HeroMobile {leftRow} {rightRow} {leftBottom} {rightBottom} />
  </div>

</section>

<style>
  .mask-fade-text {
    mask-image: linear-gradient(
      to bottom,
      transparent 5%,
      black 6%,
      black 95%,
      transparent 100%
    );
  }
</style>

<script>
  document.addEventListener("astro:page-load", () => {
    const $landing = document.querySelector("#landing")

    let currentFighterId: string | null = null

    document.addEventListener("boxer-card-exit", () => {
      $landing?.classList.remove("hidden")

      if (currentFighterId) {
        document
          .querySelector(`[data-id="hero-text-${currentFighterId}"]`)
          ?.classList.add("hidden")

        document
          .querySelector(`[data-id="hero-image-${currentFighterId}"]`)
          ?.classList.add("hidden")

        currentFighterId = null
      }
    })

    document.addEventListener("boxer-card-hovered", (event: Event) => {
      const customEvent = event as CustomEvent<{ id: string }>
      const id = customEvent.detail.id

      // si el luchador que entras es el mismo que ya se muestra
      // entonces no hacemos nada
      if (currentFighterId === id) return

      // si ya estamos mostrando un luchador, tenemos que ocultarlo
      if (currentFighterId) {
        document
          .querySelector(`[data-id="hero-text-${currentFighterId}"]`)
          ?.classList.add("hidden")

        document
          .querySelector(`[data-id="hero-image-${currentFighterId}"]`)
          ?.classList.add("hidden")
      }

      $landing?.classList.add("hidden")

      // mostramos el luchador que quiere ver el usuario
      document
        .querySelector(`[data-id="hero-text-${id}"]`)
        ?.classList.remove("hidden")

      document
        .querySelector(`[data-id="hero-image-${id}"]`)
        ?.classList.remove("hidden")

      currentFighterId = id
    })
  })
</script>
